<app-loader *ngIf="!messages"></app-loader>
<div class="w-full h-full">
    <app-modal [title]="''" [isVisible]="isModalVisible" (closeModal)="hideModal()">
            <div class="w-[80vh] h-[60vh] flex items-start justify-center ">
                <div class="h-[95%] w-[95%]">
                    <div class="h-[10%] flex items-center w-full"> 
                      <h3 class="h3 text-[#28094F]">Support Details</h3>
                    </div>
                    <div class="h-[80%] w-full flex  items-start">
                        <div class="h-[50%] pt-2 w-full flex flex-wrap">
                            <div class="w-[50%]"  >
                                <h5>User Name</h5>
                                {{editedAdmin1?.user_name}}
                                <span *ngIf="!editedAdmin1?.user_name">
                                    N/A
                                </span>
                               
                            </div>
                            <div class="w-[50%]">
                                <h5>Email</h5>
                                {{editedAdmin1?.user_email}}
                                <span *ngIf="!editedAdmin1?.user_emai">
                                    N/A
                                </span>
                                
                            </div>
                            <div class="w-[50%]">
                                <h5>Phone Number</h5>
                                {{editedAdmin1?.user_phone}}
                                <span *ngIf="!editedAdmin1?.user_phone">
                                    N/A
                                </span>
                                
                            </div>

                            <div class="w-[50%]">
                                <h5>Message Source</h5>
                                {{editedAdmin1?.source}}
                            </div>

                            <div class="mt-4 w-full" >
                                <h4 class="h4 font-bold text-[#28094F]">Recieved Messages</h4>
                            </div>

                            <div class="w-[100%]">
                               <span *ngFor="let chat of editedAdmin1?.chat">
                                <div class="w-[50%]">
                                <h5 fontweight="bold">Chat </h5>
                                    <p>{{chat.message}}</p>
                                </div>
                                       
                               </span>
                               
                            </div>


                           

                            
                        </div>
                    </div>
                    <div class="h-[10%] w-full flex justify-between">
                       <div class="btn w-[48%]">
                           <app-button buttonText="Cancel" borderColor="#F1F2F4" bgColor="transparent" (click)="toggleDialog()"></app-button>
                       </div>
                       <div class="btn w-[48%]">
                        <a routerLink="/support/{{editedAdmin1?.uuid}}/reply" class="hover:text-brand900">
                          <app-button buttonText="Reply" borderColor="#28094F" bgColor="#28094F" textColor="#FFFFFF"></app-button>
                        </a>   
                    </div>
                    </div>
                  </div>  
            </div>                                 
    </app-modal>  

    <div>
        <div >
            <div>
                <!-- <app-loader *ngIf="showLoader"></app-loader> -->
                <div *ngIf="showNoResults === true && !showLoader" class="w-full h-[80vh] flex items-center justify-center">
                    <h1 class="font-bold text-3xl text-gray-200">No Match Found</h1>
                </div>
                    <p-table *ngIf="!showLoader && !showNoResults" 
                            [value]="messages"
                            [paginator]="true"
                            [rows]="10"
                            [showCurrentPageReport]="false"
                            [tableStyle]="{ 'min-width': '100%' }"
                            currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
                            [rowsPerPageOptions]=""
                        >
                            <ng-template pTemplate="header">
                                <tr style="height: 3rem; border-color: #FAFAF9; border-top-width: 0.2px; border-bottom-width:0.2px ;">
                                    <th class="w-[20%]">User Name</th>
                                    <th class="w-[20%]">User Email</th>
                                    <th class="w-[20%]">Phone Number</th>
                                    <th class="w-[20%]">Source</th>
                                    <th class="w-[20%]">created at</th>    
                                    <th class="w-[10%]">Action</th>            
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-messages>
                                <tr style="height: 3rem; border-color: #abb4ce80; border-top-width: 0.2px; border-bottom-width:0.2px ">
                                
                                    <td>
                                        {{messages.user_name}}
                                    </td>
                                    <td>
                                        <span *ngIf="messages.user_email">{{messages.user_email}}</span>
                                        <span *ngIf="!messages.user_email">N/A</span>
                                    </td>
                                    <td>
                                        {{messages.user_phone}}
                                    </td>
                                    <td>
                                        {{messages.source}}
                                    </td>

                                    <td>
                                        {{messages.created_at}}
                                    </td>
                                   
                                    
                                    <td class="action flex justify-between">
                                        <span class="edit">
                                            <div class="flex align-items-center justify-content-center gap-2">
                                               <span (click)="userAction(messages.uuid)">
                                                <button pButton pRipple type="button" icon="fa-solid fa-message" class="p-button-rounded p-button-text"></button>
                                               </span>
                                            </div>
                                        </span>
                                    </td> 
                                </tr>
                                <div class="z-[9999] card mr-4 w-28 h-24 ml-[60rem] bg-white drop-shadow-xl absolute" *ngIf="selectedUserId === messages.uuid">
                                    <div class="h-[50%] bg-[#FAFAF9] rounded-t-md flex items-center justify-center red-400">
                                        <p class="font-small">Chat Actions</p>
                                    </div>
                                    <div class="h-[50%] flex items-center border-y-[0.5px] border-[#EEECF6] justify-center ">
                                        <span class="text-brand900 cursor-pointer hover:font-bold" (click)="editAdmin(messages)" >
                                            <span class="hover:font-medium">Reply</span> 
                                        </span>
                                    </div>
                                    <!-- <div class="h-[32%] flex items-center justify-center">
                                        <a routerLink="support/{{messages.uuid}}/reply" class="hover:text-brand900">
                                           <span class="hover:font-medium">Reply</span> 
                                        </a>
                                    </div> -->
                                   
                                </div>
                            </ng-template>
                            
                                <ng-template pTemplate="paginatorleft">
                                    <!-- <p-button type="button" icon="pi pi-plus" styleClass="p-button-text"></p-button> -->
                                </ng-template>
                                <ng-template pTemplate="paginatorright">
                                    <!-- <p-button type="button" icon="pi pi-cloud" styleClass="p-button-text"></p-button> -->
                                </ng-template>
                    </p-table>  
                </div>
                </div>
            </div>    
</div>